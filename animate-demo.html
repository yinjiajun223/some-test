<!doctype html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>高级交互与动画 GSAP 演示</title>

    <!-- 引入 Google Fonts (可选) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet" />

    <!-- 引入 Swiper.js 的 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

    <style>
      :root {
        --brand-color: #007aff;
        --background-color: #f0f2f5;
        --surface-color: #ffffff;
        --text-color: #1d1d1f;
        --text-color-light: #6e6e73;
        --border-color: #d2d2d7;
      }

      body {
        font-family: "Noto Sans SC", sans-serif;
        margin: 0;
        background-color: var(--background-color);
        color: var(--text-color);
        overscroll-behavior-x: none; /* 防止水平滚动时触发浏览器的“后退”手势 */
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 4rem 2rem;
      }

      .section {
        background-color: var(--surface-color);
        border-radius: 18px;
        padding: 3rem;
        margin-bottom: 4rem;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
      }

      h1,
      h2,
      h3 {
        font-weight: 700;
        margin-top: 0;
      }
      h2 {
        font-size: 2.5rem;
        text-align: center;
        margin-bottom: 3rem;
      }

      /* --- 1. 高级文字动画 --- */
      .hero-section {
        text-align: center;
        padding: 6rem 2rem;
        background-image: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url(https://images.unsplash.com/photo-1542051841857-5f90071e7989?w=1200&q=80);
        background-size: cover;
        background-position: center;
        color: white;
        border-radius: 18px;
      }
      .hero-title {
        font-size: 4rem;
        margin-bottom: 1rem;
        /* 准备用于 GSAP SplitText */
        clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
      }
      .hero-title .char {
        display: inline-block;
        transform: translateY(100%);
      }
      .hero-subtitle {
        font-size: 1.5rem;
        opacity: 0; /* GSAP 控制 */
      }

      /* --- 2. 魔法移动标签 --- */
      .brand-tabs-wrapper {
        position: relative;
        display: flex;
        justify-content: center;
        gap: 1.5rem;
        margin-bottom: 3rem;
      }
      .tab {
        padding: 0.75rem 1.5rem;
        cursor: pointer;
        font-weight: 500;
        position: relative;
        z-index: 2;
        color: var(--text-color-light);
        transition: color 0.4s ease;
      }
      .tab.active {
        color: var(--text-color);
      }
      .tab-highlighter {
        position: absolute;
        top: 0;
        height: 100%;
        background-color: var(--surface-color);
        border-radius: 99px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        z-index: 1;
      }

      /* 卡片网格 */
      .card-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
      }
      .card {
        background: var(--surface-color);
        border-radius: 12px;
        overflow: hidden;
        cursor: pointer;
        border: 1px solid var(--border-color);
        opacity: 0; /* GSAP 控制 */
      }
      .card-image-wrapper {
        width: 100%;
        height: 220px;
        overflow: hidden;
      }
      .card-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        transition: transform 0.6s ease-out;
      }
      .card:hover .card-image {
        transform: scale(1.05);
      }
      .card-content {
        padding: 1.5rem;
      }
      .card-title {
        margin: 0;
        font-size: 1.25rem;
      }

      /* --- 3. 图片视差效果 --- */
      .parallax-section {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 3rem;
        align-items: center;
      }
      .parallax-image-wrapper {
        height: 500px;
        border-radius: 12px;
        overflow: hidden;
      }
      .parallax-image {
        width: 100%;
        height: 140%; /* 图片需要比容器高，才有移动空间 */
        object-fit: cover;
        position: relative;
        top: -20%; /* 初始位置偏移 */
      }
      .parallax-text h3 {
        font-size: 2rem;
      }
      .parallax-text p {
        font-size: 1.1rem;
        line-height: 1.8;
        color: var(--text-color-light);
      }

      /* --- 4. 水平滚动区域 --- */
      .horizontal-scroll-section {
        padding: 0;
        overflow: hidden;
      }
      .horizontal-scroll-container {
        width: 300%; /* 宽度是子元素数量的倍数 */
        height: 100vh;
        display: flex;
        align-items: center;
      }
      .horizontal-panel {
        width: 100vw;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0 5vw;
        box-sizing: border-box;
      }
      .horizontal-panel:nth-child(odd) {
        background-color: #e2e8f0;
      }

      /* --- 5. SVG 路径动画 --- */
      .svg-icon {
        width: 80px;
        height: 80px;
        stroke: var(--brand-color);
        stroke-width: 2;
        stroke-linecap: round;
        stroke-linejoin: round;
        fill: none;
      }

      /* 弹窗 (与之前类似) */
      .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
        visibility: hidden;
        opacity: 0;
      }
      .modal-content {
        background: var(--surface-color);
        width: 90%;
        max-width: 800px;
        max-height: 90vh;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        display: flex;
        flex-direction: column;
        transform: scale(0.9);
        opacity: 0;
      }
      .modal-header {
        padding: 1rem 1.5rem;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .modal-title {
        font-size: 1.5rem;
        margin: 0;
      }
      .modal-close-btn {
        font-size: 2rem;
        line-height: 1;
        cursor: pointer;
        background: none;
        border: none;
        color: #999;
        transition: color 0.3s;
      }
      .modal-close-btn:hover {
        color: #333;
      }
      .modal-body {
        padding: 1.5rem;
        overflow-y: auto;
      }
      .swiper {
        width: 100%;
        height: 400px;
        border-radius: 8px;
        margin-bottom: 1.5rem;
      }
      .swiper-slide img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- 1. 高级文字动画 -->
      <section class="hero-section">
        <h1 class="hero-title">探索非凡旅程</h1>
        <p class="hero-subtitle">从都市的繁华到自然的静谧，我们为您精选每一处居所。</p>
      </section>

      <!-- 2. 魔法移动标签 -->
      <section class="section">
        <h2 id="brand-section-title">品牌选择</h2>
        <div class="brand-tabs-wrapper" id="brand-tabs">
          <div class="tab-highlighter"></div>
          <div class="tab active" data-brand="brandA">MIMARU</div>
          <div class="tab" data-brand="brandB">TAVINOS</div>
          <div class="tab" data-brand="brandC">MONday</div>
        </div>
        <div class="card-grid" id="card-grid"></div>
      </section>

      <!-- 3. 图片视差效果 -->
      <section class="section parallax-section">
        <div class="parallax-text">
          <h3>沉浸式体验</h3>
          <p>我们不仅仅提供住宿，更致力于打造难忘的旅行体验。每一个细节都经过精心设计，确保您的旅途舒适而充满惊喜。当您向下滚动时，感受图片带来的视觉深度。</p>
        </div>
        <div class="parallax-image-wrapper">
          <img src="https://images.unsplash.com/photo-1534351590666-13e3e96b5017?w=1200&q=80" alt="Cozy interior" class="parallax-image" />
        </div>
      </section>

      <!-- 5. SVG 路径动画 -->
      <section class="section text-center">
        <h2>我们的服务承诺</h2>
        <div style="display: flex; justify-content: space-around">
          <div>
            <svg class="svg-icon" id="svg-heart" viewBox="0 0 24 24">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
            <h3 style="margin-top: 1rem">贴心服务</h3>
          </div>
          <div>
            <svg class="svg-icon" id="svg-shield" viewBox="0 0 24 24">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
            </svg>
            <h3 style="margin-top: 1rem">安全保障</h3>
          </div>
        </div>
      </section>
    </div>

    <!-- 4. 水平滚动区域 -->
    <section class="horizontal-scroll-section">
      <div class="horizontal-scroll-container">
        <div class="horizontal-panel"><h2>横向滚动区域 1</h2></div>
        <div class="horizontal-panel"><h2>横向滚动区域 2</h2></div>
        <div class="horizontal-panel"><h2>横向滚动区域 3</h2></div>
      </div>
    </section>

    <div class="container" style="padding-top: 4rem">
      <p style="text-align: center; font-size: 1.2rem; color: var(--text-color-light)">页面内容继续...</p>
    </div>

    <!-- 弹窗 HTML (与之前相同) -->
    <div class="modal-overlay" id="modal-overlay">
      <div class="modal-content" id="modal-content">
        <header class="modal-header">
          <h2 class="modal-title" id="modal-title"></h2>
          <button class="modal-close-btn" id="modal-close-btn">&times;</button>
        </header>
        <div class="modal-body">
          <div class="swiper" id="modal-swiper">
            <div class="swiper-wrapper" id="modal-swiper-wrapper"></div>
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-pagination"></div>
          </div>
          <p id="modal-description"></p>
        </div>
      </div>
    </div>

    <!-- 引入 JS 库 -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/Flip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/SplitText.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        gsap.registerPlugin(ScrollTrigger, Flip, SplitText);

        // --- 模拟数据 ---
        const data = {
          brandA: [
            {
              id: 1,
              title: "MIMARU 东京",
              images: ["https://images.unsplash.com/photo-1560244031-6e343a42a42b?w=800", "https://images.unsplash.com/photo-1549294413-26f195200c16?w=800"],
              description: "适合家庭和团体的宽敞公寓式酒店。",
            },
            { id: 2, title: "MIMARU 京都", images: ["https://images.unsplash.com/photo-1582695578749-357125345749?w=800"], description: "在古都体验现代化的日式生活。" },
          ],
          brandB: [
            { id: 3, title: "TAVINOS 滨松町", images: ["https://images.unsplash.com/photo-1594563703937-fdc640497dcd?w=800"], description: "以漫画为主题的潮流酒店，充满活力。" },
          ],
          brandC: [
            {
              id: 4,
              title: "MONday 丰洲",
              images: ["https://images.unsplash.com/photo-1566073771259-6a8506099945?w=800", "https://images.unsplash.com/photo-1582719508461-905c673771fd?w=800"],
              description: "开启美好一周的舒适商务酒店。",
            },
            { id: 5, title: "MONday 秋叶原", images: ["https://images.unsplash.com/photo-1618773928121-c32242e63f39?w=800"], description: "探索动漫与科技文化的绝佳据点。" },
            { id: 6, title: "MONday 浅草", images: ["https://images.unsplash.com/photo-1561501900-3701fa6a0864?w=800"], description: "感受传统与现代交融的魅力。" },
          ],
        };

        // --- 动画 1: 高级文字动画 ---
        const heroTitle = new SplitText(".hero-title", { type: "chars" });
        gsap
          .timeline({ delay: 0.2 })
          .from(heroTitle.chars, {
            duration: 1,
            y: "100%",
            stagger: 0.05,
            ease: "power3.out",
          })
          .to(
            ".hero-subtitle",
            {
              duration: 1,
              opacity: 1,
              ease: "power3.out",
            },
            "-=0.8"
          );

        // --- 动画 2: 魔法移动标签 ---
        const tabs = gsap.utils.toArray(".tab");
        const highlighter = document.querySelector(".tab-highlighter");
        const cardGrid = document.getElementById("card-grid");

        function moveHighlighter(targetTab) {
          const state = Flip.getState(highlighter);
          targetTab.appendChild(highlighter);
          Flip.from(state, {
            duration: 0.5,
            ease: "power3.inOut",
          });
        }

        function renderCards(brand) {
          const cardsData = data[brand] || [];
          gsap.to(".card", {
            duration: 0.3,
            opacity: 0,
            y: 20,
            stagger: 0.05,
            onComplete: () => {
              cardGrid.innerHTML = "";
              cardsData.forEach((item) => {
                const cardEl = document.createElement("div");
                cardEl.className = "card";
                cardEl.dataset.id = item.id;
                cardEl.dataset.brand = brand;
                cardEl.innerHTML = `<div class="card-image-wrapper"><img src="${item.images[0]}" alt="${item.title}" class="card-image"></div><div class="card-content"><h3 class="card-title">${item.title}</h3></div>`;
                cardGrid.appendChild(cardEl);
              });
              gsap.to(".card", { duration: 0.5, opacity: 1, y: 0, stagger: 0.1, ease: "power3.out" });
            },
          });
        }

        tabs.forEach((tab) => {
          tab.addEventListener("click", () => {
            if (tab.classList.contains("active")) return;
            const activeTab = document.querySelector(".tab.active");
            activeTab.classList.remove("active");
            tab.classList.add("active");
            moveHighlighter(tab);
            renderCards(tab.dataset.brand);
          });
        });

        // 初始化高亮条位置和卡片
        moveHighlighter(document.querySelector(".tab.active"));
        renderCards("brandA");

        // --- 动画 3: 图片视差效果 ---
        gsap.to(".parallax-image", {
          yPercent: 20,
          ease: "none",
          scrollTrigger: {
            trigger: ".parallax-section",
            start: "top bottom",
            end: "bottom top",
            scrub: true,
          },
        });

        // --- 动画 4: 水平滚动 ---
        const horizontalContainer = document.querySelector(".horizontal-scroll-container");
        gsap.to(horizontalContainer, {
          x: () => -(horizontalContainer.scrollWidth - document.documentElement.clientWidth) + "px",
          ease: "none",
          scrollTrigger: {
            trigger: ".horizontal-scroll-section",
            start: "top top",
            end: () => "+=" + (horizontalContainer.scrollWidth - document.documentElement.clientWidth),
            scrub: 1,
            pin: true,
            invalidateOnRefresh: true,
          },
        });

        // --- 动画 5: SVG 路径动画 ---
        function animateSVG(selector) {
          const el = document.querySelector(selector);
          const length = el.getTotalLength();
          gsap.set(el, { strokeDasharray: length });
          gsap.fromTo(
            el,
            { strokeDashoffset: length },
            {
              strokeDashoffset: 0,
              duration: 2,
              ease: "power2.inOut",
              scrollTrigger: {
                trigger: el,
                start: "top 80%",
              },
            }
          );
        }
        animateSVG("#svg-heart path");
        animateSVG("#svg-shield path");

        // --- 弹窗功能 (与之前相同) ---
        const modalOverlay = document.getElementById("modal-overlay");
        const modalContent = document.getElementById("modal-content");
        let swiperInstance = null;
        const modalTl = gsap.timeline({ paused: true, reversed: true });
        modalTl.to(modalOverlay, { autoAlpha: 1, duration: 0.3 }).to(modalContent, { opacity: 1, scale: 1, duration: 0.4, ease: "power3.out" }, "-=0.2");

        function openModal(cardId, brand) {
          const item = data[brand].find((d) => d.id == cardId);
          if (!item) return;
          document.getElementById("modal-title").textContent = item.title;
          document.getElementById("modal-description").textContent = item.description;
          const swiperWrapper = document.getElementById("modal-swiper-wrapper");
          swiperWrapper.innerHTML = item.images.map((img) => `<div class="swiper-slide"><img src="${img}" alt="${item.title}"></div>`).join("");
          modalTl.play();
          swiperInstance = new Swiper("#modal-swiper", {
            loop: true,
            pagination: { el: ".swiper-pagination", clickable: true },
            navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" },
          });
        }
        function closeModal() {
          modalTl.reverse();
          if (swiperInstance) {
            setTimeout(() => swiperInstance.destroy(), 500);
          }
        }
        cardGrid.addEventListener("click", (e) => {
          const card = e.target.closest(".card");
          if (card) openModal(card.dataset.id, card.dataset.brand);
        });
        document.getElementById("modal-close-btn").addEventListener("click", closeModal);
        modalOverlay.addEventListener("click", (e) => {
          if (e.target === modalOverlay) closeModal();
        });
      });
    </script>
  </body>
</html>
